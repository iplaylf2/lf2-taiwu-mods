# 游戏依赖包说明

本页阐述了 `Taiwu.*` 整合思路、用途与引用建议，这些包均通过 [`game-libs.manifest.yaml`](../../projects/unmanaged-vendor/game/game-libs.manifest.yaml) 清单进行打包。

## 设计原则：语义化封装与依赖对齐

本模板将游戏官方的程序集整合为独立的 NuGet 包，其主要目的在于**将游戏自身的依赖策略清晰地暴露出来，并进行语义化封装**。

游戏本体已经包含并管理了大量第三方库（如 `Newtonsoft.Json`、`0Harmony` 等）。此打包策略并非创造新的依赖关系，而是将这些现有的、零散的 DLL 文件，按照其功能（后端、前端、补丁等）组织成具有明确语义的 NuGet 包。

这样做的主动价值在于：

- **简化依赖引用**：Mod 开发者不再需要从上百个 DLL 中手动挑选所需文件，只需引用如 `Taiwu.Backend` 这样高内聚的包即可。
- **降低冲突风险**：通过引用这些预设的包，可以确保你的 Mod 使用的第三方库版本与游戏完全一致，从源头上避免了因误引入不同版本库而导致的冲突。
- **促进关注点分离**：通过将依赖项细分为功能性包，一个模块可以仅引用其需要的子集，例如，一个纯粹的代码修改模块可以只依赖 `Taiwu.BepInEx`，而无需引用任何游戏逻辑或 UI 相关的程序集。

## 核心依赖包整合思路

`game-libs.manifest.yaml` 清单将上百个游戏文件整合为数个独立的 NuGet 包。理解其整合思路有助于你更好地选择依赖。

### 1. 游戏核心逻辑

这是 Mod 开发中最常引用的部分，对应游戏的核心逻辑，可划分为三个部分：

- **`Taiwu.Backend`**：包含了游戏的核心后端逻辑程序集。当你的 Mod 需要与游戏的核心数据、存档、角色逻辑等进行交互时，这是必需的依赖。
- **`Taiwu.Frontend`**：包含了游戏的前端相关程序集，如 UI、视图、资源逻辑等。如果你的 Mod 需要修改或创建新的游戏界面、响应用户输入，你需要引用此包。
- **`Taiwu.Shared`**：包含了游戏前后端共享的核心程序集。部分工具库和数据结构在前后端均有提供，此包旨在统一这些共享部分。

### 2. Modding 核心框架

这部分提供了让 Mod 得以运行和修改游戏的基础设施。

- **`Taiwu.Modding`**：官方 Mod 入口，是让你的 Mod 被游戏识别的“钥匙”。所有 Mod 都必须引用此库。
- **`Taiwu.BepInEx`**：包含了 `0Harmony`、`Mono.Cecil` 等一系列用于代码补丁的库。当你需要使用 HarmonyX 等技术在运行时修改游戏的原有代码（即“打补丁”）时，引用此包可以让你直接获得所有必要的工具。

### 3. 游戏内建三方库

游戏本体依赖了大量第三方库。为了避免 Mod 引入不兼容的版本导致冲突，这些库也被一并打包。当你的 Mod 需要使用到这些库时，**应优先引用这些 `Taiwu.*` 的版本**。

例如：

- **`Taiwu.Newtonsoft.Json`**：用于处理 JSON 序列化。
- **`Taiwu.MoonSharp`**：用于执行 Lua 脚本。
- ...以及其他如 `Google.Protobuf`, `NLog`, `Spine` 等。

### 4. Unity 引擎库

Unity 引擎相关的程序集数量庞大，因此也按用途进行了归类：

- **`Taiwu.Unity.Core`**：包含了最常用和核心的 Unity 引擎模块。
- **`Taiwu.Unity.Addons`**：包含了如 `TextMeshPro`, `Timeline` 等 Unity 的附加组件。
- **`Taiwu.Unity.Services`**：包含了与 Unity Analytics 等在线服务相关的库。

通过这种方式，Mod 可以根据需要仅引用部分 Unity 库，而不必一次性引用全部。
